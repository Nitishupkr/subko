{{ 'component-product-item.css' | asset_url | stylesheet_tag }}

<div class="container--large {% unless section.settings.remove_margin %} container--vertical-space {% endunless %} {% if section.settings.section_background_color != "rgba(0,0,0,0)" %} container--has-background {% endif %} remove-empty-space">

  {%- render 'section-heading', heading: section.settings.heading, subheading: section.settings.subheading, button: section.settings.show_view_all, button_label: 'collections.view_all_products', link: collections[section.settings.collection_1].url, heading_tag: section.settings.seo_h_tag, layout: section.settings.section_heading_layout -%}

  <div class="tab-container">
    <div class="tabs">
      <button class="tab-link active" onclick="openTab(event, 'collection_1')">{{ collections[section.settings.collection_1].title }}</button>
      <button class="tab-link" onclick="openTab(event, 'collection_2')">{{ collections[section.settings.collection_2].title }}</button>
      <button class="tab-link" onclick="openTab(event, 'collection_3')">{{ collections[section.settings.collection_3].title }}</button>
      <button class="tab-link" onclick="openTab(event, 'collection_4')">{{ collections[section.settings.collection_4].title }}</button>
    </div>

    <div id="collection_1" class="tab-content active">
      <div class="grid {{ section.settings.layout }}">
        {%- for product in collections[section.settings.collection_1].products limit: section.settings.products_number %}
          {% if section.index == 1 and forloop.index <= 4 %}
            {% assign preload = true %}
          {% else %}
            {% assign preload = false %}
          {% endif %}
          {%- render 'product-item', product: product, product_collection: collections[section.settings.collection_1], section_blocks: section.blocks, index: forloop.index, layout: section.settings.layout, preload: preload -%}
        {%- endfor %}
      </div>
    </div>

    <div id="collection_2" class="tab-content">
      <div class="grid {{ section.settings.layout }}">
        {%- for product in collections[section.settings.collection_2].products limit: section.settings.products_number %}
          {% if section.index == 1 and forloop.index <= 4 %}
            {% assign preload = true %}
          {% else %}
            {% assign preload = false %}
          {% endif %}
          {%- render 'product-item', product: product, product_collection: collections[section.settings.collection_2], section_blocks: section.blocks, index: forloop.index, layout: section.settings.layout, preload: preload -%}
        {%- endfor %}
      </div>
    </div>

    <div id="collection_3" class="tab-content">
      <div class="grid {{ section.settings.layout }}">
        {%- for product in collections[section.settings.collection_3].products limit: section.settings.products_number %}
          {% if section.index == 1 and forloop.index <= 4 %}
            {% assign preload = true %}
          {% else %}
            {% assign preload = false %}
          {% endif %}
          {%- render 'product-item', product: product, product_collection: collections[section.settings.collection_3], section_blocks: section.blocks, index: forloop.index, layout: section.settings.layout, preload: preload -%}
        {%- endfor %}
      </div>
    </div>

    <div id="collection_4" class="tab-content">
      <div class="grid {{ section.settings.layout }}">
        {%- for product in collections[section.settings.collection_4].products limit: section.settings.products_number %}
          {% if section.index == 1 and forloop.index <= 4 %}
            {% assign preload = true %}
          {% else %}
            {% assign preload = false %}
          {% endif %}
          {%- render 'product-item', product: product, product_collection: collections[section.settings.collection_4], section_blocks: section.blocks, index: forloop.index, layout: section.settings.layout, preload: preload -%}
        {%- endfor %}
      </div>
    </div>
  </div>

  {%- if section.settings.show_view_all and section.settings.section_heading_layout contains 'center' -%}
    <div class="gutter-top--large align-content align-content--horizontal-center">
      <a class="button button--outline button--regular" href="{{ collections[section.settings.collection_1].url }}">{{ 'collections.view_all_products' | t }}</a>
    </div>
  {%- endif -%}

</div>

{%- if section.settings.section_background_color != "rgba(0,0,0,0)" -%}
  {% style %}
    #shopify-section-{{ section.id }} .container--has-background {
      --color-background-section: {{ section.settings.section_background_color }};
    }
  {% endstyle %}
{%- endif -%}

{%- if section.settings.section_heading_color != "rgba(0,0,0,0)" -%}
  {% style %}
    #shopify-section-{{ section.id }} {
      --color-text-main: {{ section.settings.section_heading_color }};
    }
  {% endstyle %}
{%- endif -%}

<script>
function openTab(evt, collectionName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tab-content");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tab-link");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(collectionName).style.display = "block";
  evt.currentTarget.className += " active";
}
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector('.tab-content').style.display = 'block';
});
</script>

{% schema %}
{
  "name": "t:sections.featured-collection.name",
  "class": "mount-css-slider",
  "settings": [
    {
      "type": "header",
      "content": "t:local-march-update.labels.heading"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.local-extra-words.sections.headings.heading",
      "default": "Featured collection"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "t:sections.local-extra-words.sections.headings.subheading",
      "default": "Showcase your best products"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "t:sections.featured-collection.settings.show_view_all.label",
      "default": true
    },
    {
      "type": "select",
      "id": "section_heading_layout",
      "label": "t:sections.rich-text.settings.text_alignment.label",
      "options": [
        {
          "value": "section-heading--left",
          "label": "t:sections.rich-text.settings.text_alignment.options__1.label"
        },
        {
          "value": "section-heading--center",
          "label": "t:sections.rich-text.settings.text_alignment.options__2.label"
        }
      ],
      "default": "section-heading--left"
    },
    {
      "type": "header",
      "content": "t:sections.main-article.blocks.content.name"
    },
    {
      "type": "select",
      "id": "style",
      "label": "t:sections.featured-collection.settings.layout.label",
      "options": [
        {
          "label": "t:sections.featured-collection.settings.layout.options__1.label",
          "value": "slider"
        },
        {
          "label": "t:sections.featured-collection.settings.layout.options__2.label",
          "value": "grid"
        }
      ],
      "default": "grid"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "t:sections.local-extra-words.sections.columns.name",
      "info": "t:sections.local-extra-words.sections.columns.info",
      "options": [
        {
          "value": "grid-3 grid-lap-2 grid-tiny-1",
          "label": "t:sections.local-extra-words.sections.columns.option__2"
        },
        {
          "value": "grid-4 grid-portable-3 grid-lap-2 grid-tiny-1",
          "label": "t:sections.local-extra-words.sections.columns.option__3"
        }
      ],
      "default": "grid-4 grid-portable-3 grid-lap-2 grid-tiny-1"
    },
    {
      "type": "range",
      "id": "products_number",
      "label": "t:sections.featured-collection.settings.products_number.label",
      "min": 4,
      "max": 16,
      "step": 1,
      "default": 8
    },
    {
      "type": "collection",
      "id": "collection_1",
      "label": "t:sections.featured-collection.settings.collection.label"
    },
    {
      "type": "collection",
      "id": "collection_2",
      "label": "t:sections.featured-collection.settings.collection.label"
    },
    {
      "type": "collection",
      "id": "collection_3",
      "label": "t:sections.featured-collection.settings.collection.label"
    },
    {
      "type": "collection",
      "id": "collection_4",
      "label": "t:sections.featured-collection.settings.collection.label"
    },
    ],
    "presets": [
      {
        "name": "t:sections.featured-collection.name",
        "category": "Home"
      }
    ]
  }
{% endschema %}
